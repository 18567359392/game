# å¿«é€Ÿå¼€å§‹

<cite>
**æœ¬æ–‡æ¡£å¼•ç”¨çš„æ–‡ä»¶**
- [package.json](file://civilization-game/package.json)
- [vite.config.ts](file://civilization-game/vite.config.ts)
- [README.md](file://README.md)
- [tsconfig.json](file://civilization-game/tsconfig.json)
- [tsconfig.app.json](file://civilization-game/tsconfig.app.json)
</cite>

## ç›®å½•
1. [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
2. [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
3. [é¡¹ç›®è®¾ç½®](#é¡¹ç›®è®¾ç½®)
4. [å¼€å‘æµç¨‹](#å¼€å‘æµç¨‹)
5. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
6. [é…ç½®è¯¦è§£](#é…ç½®è¯¦è§£)
7. [å¸¸è§é—®é¢˜è§£å†³](#å¸¸è§é—®é¢˜è§£å†³)
8. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

## é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäºVue 3 + TypeScriptå¼€å‘çš„çº¯å‰ç«¯æ–‡æ˜å‘å±•æ¨¡æ‹Ÿæ¸¸æˆï¼Œä»çŸ³å™¨æ—¶ä»£å‘å±•åˆ°è¶…ç»´æ—¶ä»£ï¼Œä½“éªŒäººç±»æ–‡æ˜çš„å®Œæ•´æ¼”è¿›å†ç¨‹ã€‚æ¸¸æˆé‡‡ç”¨ç°ä»£åŒ–å‰ç«¯æŠ€æœ¯æ ˆï¼Œæä¾›æµç•…çš„60fpsæ¸¸æˆä½“éªŒå’Œä¸°å¯Œçš„æ¸¸æˆç©æ³•ã€‚

### æ ¸å¿ƒç‰¹è‰²
- ğŸ—ï¸ **ä¸°å¯Œå»ºç­‘ç³»ç»Ÿ** - 86ä¸ªç‹¬ç‰¹å»ºç­‘ï¼Œè¦†ç›–8ä¸ªæ–‡æ˜æ—¶ä»£
- ğŸ”¬ **å®Œæ•´ç§‘æŠ€æ ‘** - 55+ä¸ªç§‘æŠ€ï¼Œé€æ­¥è§£é”é«˜çº§åŠŸèƒ½
- ğŸ† **æˆå°±ç³»ç»Ÿ** - 50ä¸ªæˆå°±ç­‰å¾…è§£é”ï¼Œæ¯ä¸ªéƒ½æœ‰ç‹¬ç‰¹å¥–åŠ±
- â±ï¸ **ç¦»çº¿æ”¶ç›Š** - ç¦»çº¿æ—¶ä¹Ÿèƒ½ç§¯ç´¯èµ„æºï¼ˆæœ€å¤š8å°æ—¶ï¼‰
- ğŸ“± **ç§»åŠ¨ç«¯é€‚é…** - å®Œç¾æ”¯æŒæ‰‹æœºã€å¹³æ¿ã€æ¡Œé¢å¤šç«¯ä½“éªŒ
- ğŸ’¾ **æ™ºèƒ½å­˜æ¡£** - è‡ªåŠ¨ä¿å­˜+å‹ç¼©ï¼Œå­˜æ¡£ä½“ç§¯å‡å°‘50%
- âš¡ **é«˜æ€§èƒ½** - 60fpsæµç•…è¿è¡Œï¼Œå®æ—¶FPSç›‘æ§

## ç¯å¢ƒè¦æ±‚

### Node.js å’Œ npm ç‰ˆæœ¬è¦æ±‚

```bash
# æ£€æŸ¥Node.jsç‰ˆæœ¬
node --version
# åº”è¯¥ >= 18.0.0

# æ£€æŸ¥npmç‰ˆæœ¬
npm --version
# åº”è¯¥ >= 9.0.0
```

### æ¨èç¯å¢ƒé…ç½®

- **æ“ä½œç³»ç»Ÿ**ï¼šWindows 10+, macOS 10.15+, æˆ– Linux
- **å†…å­˜**ï¼šè‡³å°‘4GB RAM
- **å­˜å‚¨**ï¼šè‡³å°‘2GBå¯ç”¨ç©ºé—´
- **ç½‘ç»œ**ï¼šç¨³å®šçš„äº’è”ç½‘è¿æ¥ï¼ˆç”¨äºä¸‹è½½ä¾èµ–ï¼‰

## é¡¹ç›®è®¾ç½®

### æ­¥éª¤1ï¼šå…‹éš†é¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°
git clone https://github.com/18567359392/game.git

# è¿›å…¥é¡¹ç›®ç›®å½•
cd game/civilization-game
```

### æ­¥éª¤2ï¼šå®‰è£…ä¾èµ–

```bash
# å®‰è£…æ‰€æœ‰å¿…è¦çš„ä¾èµ–åŒ…
npm install
```

**å®‰è£…è¿‡ç¨‹è¯´æ˜**ï¼š
- ä¸‹è½½å¹¶å®‰è£…Vue 3.5.22
- å®‰è£…TypeScript 5.9.3
- å®‰è£…Viteæ„å»ºå·¥å…·
- å®‰è£…PiniaçŠ¶æ€ç®¡ç†
- å®‰è£…å„ç§å¼€å‘å·¥å…·å’Œåº“

### æ­¥éª¤3ï¼šéªŒè¯å®‰è£…

```bash
# æ£€æŸ¥ä¾èµ–æ˜¯å¦æ­£ç¡®å®‰è£…
npm list vue pinia vite typescript
```

## å¼€å‘æµç¨‹

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

**å¼€å‘æœåŠ¡å™¨ç‰¹æ€§**ï¼š
- å¯åŠ¨åœ¨ http://localhost:5173/
- æ”¯æŒçƒ­æ¨¡å—æ›¿æ¢(HMR)
- å®æ—¶é”™è¯¯æç¤º
- æ”¯æŒTypeScriptç±»å‹æ£€æŸ¥

### å¼€å‘å·¥ä½œæµ

```mermaid
flowchart TD
Start([å¼€å§‹å¼€å‘]) --> Clone["å…‹éš†é¡¹ç›®"]
Clone --> Install["å®‰è£…ä¾èµ–<br/>npm install"]
Install --> Dev["å¯åŠ¨å¼€å‘æœåŠ¡å™¨<br/>npm run dev"]
Dev --> Edit["ç¼–è¾‘ä»£ç "]
Edit --> Test["æµ‹è¯•åŠŸèƒ½"]
Test --> Commit{"æäº¤æ›´æ”¹?"}
Commit --> |æ˜¯| GitCommit["git commit"]
Commit --> |å¦| Edit
GitCommit --> Push["æ¨é€ä»£ç "]
Push --> End([å®Œæˆ])
```

**å›¾è¡¨æ¥æº**
- [package.json](file://civilization-game/package.json#L6-L10)

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
# ç”Ÿäº§æ„å»º
npm run build

# é¢„è§ˆæ„å»ºç»“æœ
npm run preview
```

**æ„å»ºè¿‡ç¨‹è¯´æ˜**ï¼š
- TypeScriptç¼–è¯‘
- ä»£ç å‹ç¼©å’Œæ··æ·†
- èµ„æºä¼˜åŒ–
- ç”Ÿæˆé™æ€æ–‡ä»¶

## æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

```mermaid
graph TB
subgraph "å‰ç«¯æ¡†æ¶"
Vue["Vue 3.5<br/>Composition API"]
TS["TypeScript 5.9<br/>ç±»å‹å®‰å…¨"]
Pinia["Pinia<br/>çŠ¶æ€ç®¡ç†"]
end
subgraph "æ„å»ºå·¥å…·"
Vite["Vite<br/>æé€Ÿå¼€å‘"]
UnoCSS["UnoCSS<br/>åŸå­åŒ–CSS"]
Rollup["Rollup<br/>ä»£ç æ‰“åŒ…"]
end
subgraph "UIç»„ä»¶"
HeadlessUI["Headless UI<br/>æ— éšœç¢ç»„ä»¶"]
Iconify["Iconify Vue<br/>å›¾æ ‡åº“"]
Custom["è‡ªå®šä¹‰ç»„ä»¶<br/>æ¸¸æˆUI"]
end
Vue --> Pinia
Vue --> TS
Vite --> UnoCSS
Vite --> Rollup
Vue --> HeadlessUI
Vue --> Iconify
Vue --> Custom
```

**å›¾è¡¨æ¥æº**
- [package.json](file://civilization-game/package.json#L12-L28)
- [vite.config.ts](file://civilization-game/vite.config.ts#L8-L15)

### é¡¹ç›®ç»“æ„æ¦‚è§ˆ

```mermaid
graph TD
Root[civilization-game/] --> Src[src/]
Root --> Config[vite.config.ts<br/>uno.config.ts<br/>tsconfig.json]
Root --> Static[index.html<br/>package.json]
Src --> Components[components/<br/>æ¸¸æˆç»„ä»¶]
Src --> Stores[stores/<br/>çŠ¶æ€ç®¡ç†]
Src --> ConfigDir[config/<br/>æ¸¸æˆé…ç½®]
Src --> Utils[utils/<br/>å·¥å…·å‡½æ•°]
Src --> Composables[composables/<br/>ç»„åˆå¼å‡½æ•°]
Components --> UI[ui/<br/>åŸºç¡€UIç»„ä»¶]
Components --> Game[game/<br/>æ¸¸æˆä¸šåŠ¡ç»„ä»¶]
Stores --> GameStore[game.ts<br/>æ¸¸æˆæ ¸å¿ƒ]
Stores --> ResourceStore[resource.ts<br/>èµ„æºç®¡ç†]
Stores --> BuildingStore[building.ts<br/>å»ºç­‘ç®¡ç†]
Stores --> TechStore[tech.ts<br/>ç§‘æŠ€ç®¡ç†]
Stores --> AchievementStore[achievement.ts<br/>æˆå°±ç®¡ç†]
Stores --> SaveStore[save.ts<br/>å­˜æ¡£ç®¡ç†]
```

**å›¾è¡¨æ¥æº**
- [README.md](file://README.md#L200-L250)

## é…ç½®è¯¦è§£

### package.json è„šæœ¬é…ç½®

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vue-tsc -b && vite build",
    "preview": "vite preview"
  }
}
```

**è„šæœ¬è¯´æ˜**ï¼š
- `dev`ï¼šå¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œæ”¯æŒçƒ­é‡è½½
- `build`ï¼šå…ˆè¿›è¡ŒTypeScriptç¼–è¯‘ï¼Œç„¶åæ„å»ºç”Ÿäº§ç‰ˆæœ¬
- `preview`ï¼šé¢„è§ˆç”Ÿäº§æ„å»ºç»“æœ

### Vite é…ç½®è¯¦è§£

```typescript
export default defineConfig({
  plugins: [
    vue({
      script: {
        defineModel: true,
        propsDestructure: true
      }
    }),
    UnoCSS()
  ],
  resolve: {
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url))
    }
  },
  build: {
    target: 'es2020',
    rollupOptions: {
      output: {
        manualChunks(id) {
          if (id.includes('node_modules')) {
            if (id.includes('vue') || id.includes('pinia')) {
              return 'vue-vendor'
            }
            if (id.includes('@iconify')) {
              return 'iconify'
            }
          }
        }
      }
    },
    chunkSizeWarningLimit: 1000,
    minify: 'esbuild'
  }
})
```

**é…ç½®è¦ç‚¹**ï¼š
- **æ’ä»¶è®¾ç½®**ï¼šVue 3.5 + UnoCSS
- **åˆ«åé…ç½®**ï¼š`@`æŒ‡å‘`src`ç›®å½•
- **ä»£ç åˆ†å‰²**ï¼šVueç›¸å…³åº“ç‹¬ç«‹æ‰“åŒ…
- **æ€§èƒ½ä¼˜åŒ–**ï¼šES2020ç›®æ ‡ + esbuildå‹ç¼©

### TypeScript é…ç½®

```json
{
  "extends": "@vue/tsconfig/tsconfig.dom.json",
  "compilerOptions": {
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true
  }
}
```

**ä¸¥æ ¼æ¨¡å¼ç‰¹æ€§**ï¼š
- ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥
- æœªä½¿ç”¨å˜é‡è­¦å‘Š
- switchè¯­å¥å®Œæ•´æ€§æ£€æŸ¥
- æ— å‰¯ä½œç”¨å¯¼å…¥æ£€æŸ¥

**ç« èŠ‚æ¥æº**
- [package.json](file://civilization-game/package.json#L1-L35)
- [vite.config.ts](file://civilization-game/vite.config.ts#L1-L45)
- [tsconfig.app.json](file://civilization-game/tsconfig.app.json#L1-L21)

## å¸¸è§é—®é¢˜è§£å†³

### ä¾èµ–å®‰è£…å¤±è´¥

**é—®é¢˜ç—‡çŠ¶**ï¼š
```bash
npm install
# é”™è¯¯ï¼šæ— æ³•æ‰¾åˆ°åŒ…æˆ–ç½‘ç»œè¿æ¥é—®é¢˜
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **æ¸…ç†ç¼“å­˜**ï¼š
```bash
npm cache clean --force
```

2. **ä½¿ç”¨æ·˜å®é•œåƒ**ï¼š
```bash
npm install --registry=https://registry.npmmirror.com
```

3. **æ£€æŸ¥ç½‘ç»œè¿æ¥**ï¼š
```bash
# æµ‹è¯•npm registryè¿é€šæ€§
curl -I https://registry.npmjs.org/
```

### ç«¯å£å†²çª

**é—®é¢˜ç—‡çŠ¶**ï¼š
```bash
PORT 5173 is already in use
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **æ›´æ¢ç«¯å£**ï¼š
```bash
# åˆ›å»º.env.developmentæ–‡ä»¶
echo "VITE_PORT=5174" > .env.development
```

2. **æŸ¥æ‰¾å¹¶ç»ˆæ­¢å ç”¨è¿›ç¨‹**ï¼š
```bash
# Windows
netstat -ano | findstr :5173
taskkill /PID <PID> /F

# macOS/Linux
lsof -ti:5173 | xargs kill -9
```

### TypeScript ç¼–è¯‘é”™è¯¯

**é—®é¢˜ç—‡çŠ¶**ï¼š
```bash
npm run build
# é”™è¯¯ï¼šTypeScriptç¼–è¯‘å¤±è´¥
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **æ£€æŸ¥TypeScriptç‰ˆæœ¬**ï¼š
```bash
npx tsc --version
# åº”è¯¥åŒ¹é…package.jsonä¸­çš„ç‰ˆæœ¬
```

2. **æ¸…ç†æ„å»ºç¼“å­˜**ï¼š
```bash
rm -rf node_modules/.cache
```

3. **å•ç‹¬è¿è¡Œç±»å‹æ£€æŸ¥**ï¼š
```bash
npm run type-check
```

### å†…å­˜ä¸è¶³

**é—®é¢˜ç—‡çŠ¶**ï¼š
```bash
JavaScript heap out of memory
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **å¢åŠ Nodeå†…å­˜é™åˆ¶**ï¼š
```bash
# Windows
set NODE_OPTIONS=--max-old-space-size=4096
npm run dev

# macOS/Linux
export NODE_OPTIONS=--max-old-space-size=4096
npm run dev
```

2. **è°ƒæ•´Viteé…ç½®**ï¼š
```javascript
// vite.config.ts
export default defineConfig({
  server: {
    watch: {
      usePolling: true
    }
  }
})
```

## æœ€ä½³å®è·µ

### å¼€å‘ç¯å¢ƒè®¾ç½®

1. **IDEæ¨èé…ç½®**ï¼š
   - VS Code + Vueæ‰©å±•
   - TypeScripté…ç½®æ–‡ä»¶
   - ESLint + Prettier

2. **å¼€å‘å·¥å…·**ï¼š
   - Vue DevTools
   - Pinia DevTools
   - Network Monitor

3. **è°ƒè¯•æŠ€å·§**ï¼š
   ```javascript
   // åœ¨ä»£ç ä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯
   console.log('[DEBUG]', { state, action })
   
   // ä½¿ç”¨Vue DevToolsæ£€æŸ¥çŠ¶æ€
   window.__VUE_DEVTOOLS_GLOBAL_HOOK__ = true
   ```

### ä»£ç è´¨é‡ä¿è¯

1. **ç±»å‹å®‰å…¨**ï¼š
   ```typescript
   // ä½¿ç”¨ä¸¥æ ¼çš„ç±»å‹å®šä¹‰
   interface Building {
     id: string
     name: string
     type: BuildingType
     level: number
   }
   ```

2. **çŠ¶æ€ç®¡ç†**ï¼š
   ```typescript
   // ä½¿ç”¨Piniaè¿›è¡ŒçŠ¶æ€ç®¡ç†
   export const useGameStore = defineStore('game', () => {
     const gameTime = ref(0)
     
     function tick(delta: number) {
       gameTime.value += delta
     }
     
     return { gameTime, tick }
   })
   ```

3. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   ```typescript
   // ä½¿ç”¨requestAnimationFrameä¼˜åŒ–æ¸¸æˆå¾ªç¯
   function gameLoop(timestamp: number) {
     const deltaTime = timestamp - lastTimestamp
     updateGame(deltaTime)
     requestAnimationFrame(gameLoop)
   }
   ```

### é¡¹ç›®ç»´æŠ¤

1. **å®šæœŸæ›´æ–°ä¾èµ–**ï¼š
```bash
# æ£€æŸ¥è¿‡æœŸä¾èµ–
npm outdated

# æ›´æ–°ä¾èµ–
npm update
```

2. **ä»£ç æ ¼å¼åŒ–**ï¼š
```bash
# æ ¼å¼åŒ–ä»£ç 
npm run lint:fix

# ç±»å‹æ£€æŸ¥
npm run type-check
```

3. **æ„å»ºä¼˜åŒ–**ï¼š
```bash
# åˆ†ææ„å»ºäº§ç‰©
npm run build -- --analyze

# ç”ŸæˆæŠ¥å‘Š
npm run build -- --report
```

**ç« èŠ‚æ¥æº**
- [README.md](file://README.md#L700-L881)